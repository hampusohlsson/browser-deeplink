/**
 * browser-deeplink v0.1
 *
 * Author: Hampus Ohlsson, Nov 2014
 * GitHub: http://github.com/hampusohlsson/browser-deeplink
 *
 * MIT License
 */

!function(n,e){"function"==typeof define&&define.amd?define("deeplink",e(n)):"object"==typeof exports?module.exports=e(n):n.deeplink=e(n)}(window||this,function(n){"use strict";if(n.document&&n.navigator){var e,t={},a={iOS:{},android:{},androidDisabled:!1,fallback:!0,fallbackToWeb:!1,delay:1e3,delta:500},r=function(n,e){var t={};for(var a in n)t[a]=n[a];for(var a in e)t[a]=e[a];return t},i=function(){var n="itms-apps://itunes.apple.com/app/",e=t.iOS.appName,a=t.iOS.appId;return a&&e?n+e+"/id"+a+"?mt=8":null},o=function(){var n="market://details?id=",e=t.android.appId;return e?n+e:null},d=function(){var n={ios:t.iOS.storeUrl||i(),android:t.android.storeUrl||o()};return n[t.platform]},u=function(){var n={ios:t.iOS.fallbackWebUrl||location.href,android:t.android.fallbackWebUrl||location.href};return n[t.platform]},c=function(){return navigator.userAgent.match("Android")},f=function(){return navigator.userAgent.match("iPad")||navigator.userAgent.match("iPhone")||navigator.userAgent.match("iPod")},l=function(){return c()||f()},p=function(n){return function(){var e=t.fallbackToWeb?u():d(),a=t.delay+t.delta;"string"==typeof e&&Date.now()-n<a&&(window.location.href=e)}},s=function(n){t=r(a,n),c()&&(t.platform="android"),f()&&(t.platform="ios")},m=function(n){if(!l())return!1;if(!c()||!t.androidDisabled){if(c()&&!navigator.userAgent.match(/Firefox/)){var a=n.match(/([^:]+):\/\/(.+)$/i);n="intent://"+a[2]+"#Intent;scheme="+a[1],n+=";package="+t.android.appId+";end"}(t.fallback||t.fallbackToWeb)&&(e=setTimeout(p(Date.now()),t.delay));var r=window.navigator.userAgent;if(r.match(/CriOS/)||r.match(/Safari/)&&function(){var n=r.match(/Version\/(\d+)/);return parseInt(n[1])>=9}())window.location.href=n;else{var i=document.createElement("iframe");i.onload=function(){clearTimeout(e),i.parentNode.removeChild(i),window.location.href=n},i.src=n,i.setAttribute("style","display:none;"),document.body.appendChild(i)}return!0}};return{setup:s,open:m}}});