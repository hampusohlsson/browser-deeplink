/**
 * browser-deeplink v0.1
 *
 * Author: Hampus Ohlsson, Nov 2014
 * GitHub: http://github.com/hampusohlsson/browser-deeplink
 *
 * MIT License
 */

 !function(n,e){"function"==typeof define&&define.amd?define("deeplink",e(n)):"object"==typeof exports?module.exports=e(n):n.deeplink=e(n)}(window||this,function(n){"use strict";if(n.document&&n.navigator){var e,t={},r={iOS:{},android:{},androidDisabled:!1,fallback:!0,delay:1e3,delta:500},a=function(n,e){var t={};for(var r in n)t[r]=n[r];for(var r in e)t[r]=e[r];return t},i=function(){var n="itms-apps://itunes.apple.com/app/",e=t.iOS.appName,r=t.iOS.appId;return r&&e?n+e+"/id"+r+"?mt=8":null},o=function(){var n="market://details?id=",e=t.android.appId;return e?n+e:null},d=function(){var n={ios:t.iOS.storeUrl||i(),android:t.android.storeUrl||o()};return n[t.platform]},u=function(){return navigator.userAgent.match("Android")},c=function(){return navigator.userAgent.match("iPad")||navigator.userAgent.match("iPhone")||navigator.userAgent.match("iPod")},l=function(){return u()||c()},f=function(n){return function(){var e=d(),r=t.delay+t.delta;"string"==typeof e&&Date.now()-n<r&&(window.location.href=e)}},p=function(n){t=a(r,n),u()&&(t.platform="android"),c()&&(t.platform="ios")},s=function(n){if(!l())return!1;if(!u()||!t.androidDisabled){if(u()&&!navigator.userAgent.match(/Firefox|OPR/)){var r=n.match(/([^:]+):\/\/(.+)$/i);n="intent://"+r[2]+"#Intent;scheme="+r[1],n+=";package="+t.android.appId+";",n+="S.browser_fallback_url="+o()+";end"}else u()&&navigator.userAgent.match(/OPR/)&&(n=o());t.fallback&&(e=setTimeout(f(Date.now()),t.delay));var a=document.createElement("iframe");return a.onload=function(){clearTimeout(e),a.parentNode.removeChild(a),window.location.href=n},a.src=n,a.setAttribute("style","display:none;"),document.body.appendChild(a),!0}};return{setup:p,open:s}}});
